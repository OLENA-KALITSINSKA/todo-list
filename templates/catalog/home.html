{% extends "base.html" %}
{% load crispy_forms_filters %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>TODO list</h1>
    <a href="{% url 'catalog:task-create' %}" class="btn btn-primary">Add task</a>
  </div>
  <ul class="list-group">
    {% for task in tasks %}
      <li class="list-group-item pb-1 mb-2 border-bottom">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <p>
              <strong>{{ task.content }}
                <span class="{% if task.is_done %}text-success{% else %}text-danger{% endif %}">
                  {% if task.is_done %}Done{% else %}Not done{% endif %}
                </span>
              </strong>
            </p>
            <p style="font-size: 13px;">
              Created: {{ task.created_at|date:"F j, Y, g:i a" }} |
              <span class="text-danger">Deadline: {{ task.deadline|date:"F j, Y, g:i a" }}</span>
            </p>
            <p class="text-muted">
              Tags: {% for tag in task.tags.all %} {{ tag.name }} {% endfor %}
              <a href="{% url 'catalog:task-update' task.id %}">Update</a>
              <a href="{% url 'catalog:task-delete' task.id %}">Delete</a>
            </p>
          </div>
          <form action="{% url 'catalog:toggle-task-status' task.id %}" method="post">
            {% csrf_token %}
            <button type="submit" class="btn {% if task.is_done %}btn-secondary{% else %}btn-success{% endif %} btn-md">
              {% if task.is_done %}Undo{% else %}Complete{% endif %}
            </button>
          </form>
        </div>
      </li>
    {% endfor %}
  </ul>
{% endblock %}
